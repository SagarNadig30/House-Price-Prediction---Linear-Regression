# -*- coding: utf-8 -*-
"""# House Price Prediction - Linear Regression

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NMJS_x_hb79wt06oxXJ0zuLR91HlXawW
"""

from google.colab import files
files.upload()

!mkdir ~/.kaggle
!mv kaggle.json ~/.kaggle/
!chmod 600 ~/.kaggle/kaggle.json

!kaggle competitions download -c house-prices-advanced-regression-techniques
!unzip house-prices-advanced-regression-techniques.zip

import pandas as pd

# Load dataset
df = pd.read_csv("train.csv")

# Check first few rows
df.head()

# ============================
# House Price Prediction - Linear Regression
# ============================

# STEP 1: Install required packages
!pip install pandas numpy scikit-learn --quiet

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# STEP 2: Load dataset
# Make sure 'train.csv' is in the same directory or uploaded to Colab
df = pd.read_csv("train.csv")

# STEP 3: Select relevant features
# GrLivArea = Above ground living area (sqft)
# BedroomAbvGr = Number of bedrooms above ground
# FullBath = Number of full bathrooms above ground
features = ["GrLivArea", "BedroomAbvGr", "FullBath"]
target = "SalePrice"

X = df[features]
y = df[target]

# STEP 4: Train-test split (80% training, 20% testing)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# STEP 5: Create and train the model
model = LinearRegression()
model.fit(X_train, y_train)

# STEP 6: Make predictions
y_pred = model.predict(X_test)

# STEP 7: Evaluate the model
rmse = np.sqrt(mean_squared_error(y_test, y_pred))
r2 = r2_score(y_test, y_pred)

print("Model Evaluation:")
print(f"Root Mean Squared Error (RMSE): {rmse:.2f}")
print(f"RÂ² Score: {r2:.4f}")

# STEP 8: Predict for a sample house
# Example: 2000 sqft, 3 bedrooms, 2 bathrooms
sample_house = pd.DataFrame([[2000, 3, 2]], columns=features)
predicted_price = model.predict(sample_house)[0]
print(f"\nPredicted Price for 2000 sqft, 3 bed, 2 bath: ${predicted_price:,.2f}")

# STEP 9: Show model coefficients
coefficients = pd.DataFrame({
    "Feature": features,
    "Coefficient": model.coef_
})
print("\nModel Coefficients:")
print(coefficients)